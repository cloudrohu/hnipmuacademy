{% extends 'base.html' %}
{% load static %}
{% block content %}

<!--
  Premium About Page
  Context variables expected:
  hero_image_url, hero_heading, hero_sub,
  mission_text, vision_text,
  impact_metrics (iterable with .value .title .description),
  team_members (iterable with .photo_url .name .role .bio .social_links),
  partners (iterable with .logo_url .name),
  timeline_events (iterable with .year .title .desc),
  gallery (iterable with .image_url .caption),
  cta_text, cta_link,
  social_links
-->

<!-- HERO (parallax, subtle overlay) -->
<!-- HERO (parallax, subtle overlay) -->
<section class="relative h-[70vh] md:h-[72vh] overflow-hidden">
  <div class="absolute inset-0 bg-fixed bg-center bg-cover"
       style="background-image: url('{% if hero_image_url %}{{ hero_image_url }}{% else %}{% static 'images/about-hero.jpg' %}{% endif %}');
              filter: saturate(0.95) brightness(0.6);">
  </div>

  <div class="absolute inset-0 bg-gradient-to-b from-black/30 to-black/40"></div>

  <div class="relative z-10 container mx-auto px-6 md:px-10 h-full flex items-center">
    <div class="max-w-3xl text-white animate-fade-up">
      <h1 class="text-4xl md:text-5xl lg:text-6xl font-extrabold leading-tight">
        {{ hero_heading|default:"About Us" }}
      </h1>

      <p class="mt-4 text-lg md:text-xl text-white/90">
        {{ hero_sub|default:"Empowering communities through compassion, innovation and action." }}
      </p>

      <div class="mt-8 flex gap-4">
        <a href="{{ cta_link|default:'#' }}"
           class="inline-block bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-6 py-3 rounded-lg font-semibold shadow-lg hover:translate-y-[-2px] transition">
          {{ cta_text|default:"Join Us / Volunteer" }}
        </a>
      </div>
    </div>
  </div>
</section>


<!-- WHO WE ARE -->
<section class="py-16 bg-white">
  <div class="container mx-auto px-6 md:px-10">
    <div class="grid md:grid-cols-2 gap-10 items-center">
      <div class="space-y-6">
        <h2 class="text-3xl md:text-4xl font-bold">Who We Are</h2>
        <p class="text-gray-700 leading-relaxed">
          {{ mission_text|default:"We work to improve lives through community-driven projects, education, health camps and digital inclusion." }}
        </p>

        <div class="mt-6 grid sm:grid-cols-2 gap-4">
          <div class="p-6 border rounded-lg shadow-sm">
            <h3 class="font-semibold text-lg">Mission</h3>
            <p class="text-gray-600 mt-2">{{ mission_text|default:"Deliver positive social impact." }}</p>
          </div>
          <div class="p-6 border rounded-lg shadow-sm">
            <h3 class="font-semibold text-lg">Vision</h3>
            <p class="text-gray-600 mt-2">{{ vision_text|default:"Create opportunity for every community member." }}</p>
          </div>
        </div>
      </div>

      <!-- optional small carousel / feature card stack -->
      <div class="space-y-4">
        <div class="rounded-xl overflow-hidden shadow-lg">
          <img src="{{ hero_image_url|default:static('images/about-card.jpg') }}" class="w-full h-64 object-cover">
        </div>
        <div class="bg-gray-50 p-6 rounded-xl shadow-sm">
          <h4 class="font-semibold">Our Approach</h4>
          <p class="text-gray-600 mt-2">Sustainable, measurable and community-led programs with local partners.</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- IMPACT / STATS (animated counters) -->
{% if impact_metrics %}
<section id="our-impact" class="py-16 bg-gray-50">
  <div class="container mx-auto px-6 md:px-10 text-center">
    <h2 class="text-3xl md:text-4xl font-bold mb-8">Our Impact</h2>

    <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
      {% for m in impact_metrics %}
      <div class="bg-white p-6 rounded-xl shadow hover:shadow-lg transition transform hover:-translate-y-1">
        <div class="text-4xl md:text-5xl font-extrabold text-indigo-600 counter" data-target="{{ m.value|default:'0' }}">{{ m.value }}</div>
        <div class="mt-2 font-semibold">{{ m.title }}</div>
        {% if m.description %}<div class="mt-1 text-sm text-gray-500">{{ m.description }}</div>{% endif %}
      </div>
      {% endfor %}
    </div>
  </div>
</section>
{% endif %}

<!-- TEAM -->
{% if team_members %}
<section class="py-20 bg-white">
  <div class="container mx-auto px-6 md:px-10">
    <h2 class="text-3xl md:text-4xl font-bold text-center mb-10">Meet the Team</h2>

    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
      {% for t in team_members %}
      <div class="p-6 bg-gray-50 rounded-2xl shadow-sm hover:shadow-md transition">
        <div class="flex items-center gap-4">
          <div class="w-20 h-20 rounded-full overflow-hidden bg-white flex-shrink-0">
            <img src="{{ t.photo_url|default:static('images/avatar-placeholder.png') }}" alt="{{ t.name }}" class="w-full h-full object-cover">
          </div>
          <div>
            <h4 class="font-semibold">{{ t.name }}</h4>
            <div class="text-sm text-gray-500">{{ t.role }}</div>
          </div>
        </div>
        <p class="mt-4 text-gray-600 text-sm">{{ t.bio|truncatewords:28 }}</p>

        {% if t.social_links %}
        <div class="mt-4 flex gap-3">
          {% for s in t.social_links %}
            <a href="{{ s.url }}" target="_blank" class="text-indigo-600 text-sm font-medium">{{ s.platform|title }}</a>
          {% endfor %}
        </div>
        {% endif %}
      </div>
      {% endfor %}
    </div>
  </div>
</section>
{% endif %}

<!-- PARTNERS GRID -->
{% if partners %}
<section class="py-16 bg-gray-50">
  <div class="container mx-auto px-6 md:px-10">
    <h3 class="text-2xl font-semibold text-center mb-8">Our Partners</h3>

    <div class="grid grid-cols-2 md:grid-cols-6 gap-6 items-center">
      {% for p in partners %}
      <div class="flex items-center justify-center p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition">
        {% if p.logo_url %}
          <img src="{{ p.logo_url }}" alt="{{ p.name }}" class="max-h-12 object-contain">
        {% else %}
          <div class="text-sm text-gray-600">{{ p.name }}</div>
        {% endif %}
      </div>
      {% endfor %}
    </div>
  </div>
</section>
{% endif %}

<!-- TIMELINE (vertical) -->
{% if timeline_events %}
<section class="py-16 bg-white">
  <div class="container mx-auto px-6 md:px-10">
    <h3 class="text-2xl font-bold mb-8 text-center">Our Journey</h3>

    <div class="relative">
      <div class="border-l-2 border-gray-200 absolute h-full left-6 top-0"></div>
      <div class="space-y-8">
        {% for e in timeline_events %}
        <div class="pl-12 relative">
          <div class="absolute -left-3 top-1 w-6 h-6 bg-indigo-600 rounded-full border-4 border-white shadow"></div>
          <div class="bg-gray-50 p-6 rounded-lg shadow-sm">
            <div class="flex items-center justify-between">
              <div>
                <h4 class="font-semibold text-lg">{{ e.title }}</h4>
                <div class="text-sm text-gray-500">{{ e.year }}</div>
              </div>
            </div>
            <p class="mt-3 text-gray-600">{{ e.desc }}</p>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
</section>
{% endif %}

<!-- GALLERY SLIDER -->
{% if gallery %}
<section class="py-16 bg-gray-50">
  <div class="container mx-auto px-6 md:px-10">
    <h3 class="text-2xl font-bold mb-6 text-center">Gallery</h3>

    <div class="relative">
      <div id="gallery-track" class="flex gap-4 overflow-hidden">
        {% for g in gallery %}
        <div class="min-w-[320px] md:min-w-[360px] rounded-lg overflow-hidden shadow">
          <img src="{{ g.image_url }}" class="w-full h-56 object-cover">
          {% if g.caption %}<div class="p-3 text-sm text-gray-600">{{ g.caption }}</div>{% endif %}
        </div>
        {% endfor %}
      </div>

      <button id="g-prev" class="absolute left-2 top-1/2 -translate-y-1/2 bg-white/90 rounded-full p-3 shadow">‹</button>
      <button id="g-next" class="absolute right-2 top-1/2 -translate-y-1/2 bg-white/90 rounded-full p-3 shadow">›</button>
    </div>

    <div class="text-center mt-6">
      <a href="{% url 'home:gallery' %}" class="inline-block text-indigo-600 font-medium">View full gallery</a>
    </div>
  </div>
</section>
{% endif %}

<!-- CTA BANNER -->
<section class="py-12 bg-gradient-to-r from-indigo-600 to-blue-600 text-white">
  <div class="container mx-auto px-6 md:px-10 flex flex-col md:flex-row items-center justify-between gap-6">
    <div>
      <h4 class="text-2xl font-bold">Get Involved</h4>
      <p class="mt-2 text-white/90">Volunteer, donate or partner with us — every action creates change.</p>
    </div>
    <div class="flex gap-3">
      <a href="{{ cta_link|default:'#' }}" class="bg-white text-indigo-700 px-6 py-3 rounded-lg font-semibold shadow">Join / Volunteer</a>
      <a href="{% url 'home:donate' %}" class="px-6 py-3 border border-white/30 rounded-lg">Donate</a>
    </div>
  </div>
</section>

<!-- FOOTER social quick -->
{% if social_links %}
<section class="py-8 bg-white">
  <div class="container mx-auto px-6 md:px-10 text-center">
    <div class="flex items-center justify-center gap-4">
      {% for s in social_links %}
      <a href="{{ s.url }}" target="_blank" class="text-gray-600 hover:text-indigo-600">{{ s.platform|title }}</a>
      {% endfor %}
    </div>
  </div>
</section>
{% endif %}

<!-- INLINE STYLES & JS (counters + gallery slider + small animations) -->
<style>
  /* subtle animations */
  @keyframes fadeUp { from {opacity:0; transform:translateY(12px)} to {opacity:1; transform:none} }
  .animate-fade-up { animation: fadeUp .9s ease both; }

  /* responsive container fallback */
  .container { max-width:1100px; margin:0 auto; }

  /* small scrollbar hide for gallery */
  #gallery-track { scroll-behavior: smooth; }
</style>

<script>
  // Counter animation
  document.addEventListener('DOMContentLoaded', function(){
    const counters = document.querySelectorAll('.counter');
    counters.forEach(counter=>{
      const targetRaw = counter.dataset.target || counter.innerText || '0';
      // try parse integers from strings like "10,000+"
      const targetNum = Number(String(targetRaw).replace(/[^\d.]/g,'') || 0);
      let start = 0;
      const dur = 1400;
      const step = (timestamp) => {
        start += Math.ceil(targetNum / (dur/16));
        if (start >= targetNum) {
          counter.innerText = targetRaw;
        } else {
          counter.innerText = start.toLocaleString();
          requestAnimationFrame(step);
        }
      };
      requestAnimationFrame(step);
    });

    // Gallery slider simple
    const track = document.getElementById('gallery-track');
    const next = document.getElementById('g-next');
    const prev = document.getElementById('g-prev');
    if(track){
      const card = track.querySelector('div');
      const cardWidth = card ? card.getBoundingClientRect().width + 16 : 360;
      next?.addEventListener('click', ()=> track.scrollBy({ left: cardWidth, behavior:'smooth' }));
      prev?.addEventListener('click', ()=> track.scrollBy({ left: -cardWidth, behavior:'smooth' }));
    }
  });
</script>

{% endblock %}
